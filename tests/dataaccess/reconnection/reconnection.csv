action,ms,bytes,lang,code,repeat,minver,comment
beforeany,0,0,q,.proc.sys"sleep 1",1,,"Wait for all procs to go up"
before,0,0,q,.servers.startup[],1,,"Get connection management set up"
before,0,0,q,"errors:1!.dataaccess.readcsv[` sv testpath,`testdata`reconnectionerrors.csv;""s*""]",1,,"load in error to be thrown for incorrect inputs"
before,0,0,q,startorstopproc["stop";string`dailyhdb1;1_string processcsv];.proc.sys"sleep 1",,1,,"shut down dailyhdb1"
run,0,0,q,"""close handle: 5""~@[5i;"1+1";::]",1,,"Check dailyhdb1 is dead - .z.pc is called here"
true,0,0,q,checkreturnederror[`nohdb],1,,"no hdb is available for requested table"
run,0,0,q,startorstopproc["start";string`dailyhdb1;1_string processcsv];.proc.sys"sleep 1",,1,,"start dailyhdb1"
run,0,0,q,.servers.retry[],1,,"Reconnect to dailyhdb1"
true,0,0,q,99h~type getdata gettestparams`validinput1,,1,,"getdata runs successfully following reconnection"
after,0,0,q,"startorstopproc[""stop"";;1_string processcsv]'[string `discovery1`dailyhdb1`monthlyhdb1`yearlyhdb1`dailyrdb1`monthlyrdb1`yearlyrdb1]",,1,,"shut down procs"
after,0,0,q,".os.deldir 1_string` sv testpath,`dailyhdb",1,,"Delete temp HDB"
after,0,0,q,".os.deldir 1_string` sv testpath,`monthlyhdb",1,,"Delete temp HDB"
after,0,0,q,".os.deldir 1_string` sv testpath,`yearlyhdb",1,,"Delete temp HDB"
