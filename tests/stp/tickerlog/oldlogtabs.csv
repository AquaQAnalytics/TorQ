action,ms,bytes,lang,code,repeat,minver,comment
before,0,0,q,.replay.tplogfile: `$raze (":";(getenv `KDBTESTS); "/stp/tickerlog/testlogs/testoldlog"),1,,"Specifying tp log to replay from test directory."
before,0,0,q,.replay.segmentedmode:0,1,,"Old log format is a single file"
before,0,0,q,.replay.replaylog each .replay.logstoreplay,1,,"Replaying log to test hdb dir"
before,0,0,q,quote: get `$ raze(":";(getenv`KDBTESTS);"/stp/tickerlog/testhdb/quote"),1,,"load the quote table from hdb dir"
before,0,0,q,trade: get `$ raze(":";(getenv`KDBTESTS);"/stp/tickerlog/testhdb/trade"),1,,"load the trade table from hdb dir"
true,0,0,q,1965 = count quote,1,,"Count quote > 0"
true,0,0,q,400  = count trade,1,,"Count trade > 0"
true,0,0,q,10 = count meta quote,,"Count columns of quote"
true,0,0,q,10 = count meta trade,,"Count columns of trade"
run,0,0,q,.os.deldir raze(":";(getenv`KDBTESTS);"/stp/tickerlog/testhdb/"),,"Clean test hdb dir"
run,0,0,q,"delete quote,trade from `.",,"clean current test env"
run,0,0,q,.replay.tablelist:quote,1,,"Specifying table to be replayed."
run,0,0,q,.replay.replaylog each .replay.logstoreplay,1,,"Replaying log to test hdb dir"
run,0,0,q,.replay.tablelist:quote,1,,"Specifying table to be replayed."
run,0,0,q,quote: get `$ raze(":";(getenv`KDBTESTS);"/stp/tickerlog/testhdb/quote"),1,,"load the test hdb dir"
fail,0,0,q,trade: get `$ raze(":";(getenv`KDBTESTS);"/stp/tickerlog/testhdb/trade"),1,,"Check tables present in hdb"
true,0,0,q,1965 = count quote,1,,"Count quote > 0"
true,0,0,q,10 = count meta quote,,"Count columns of quote"
after,0,0,q,.os.deldir raze(":";(getenv`KDBTESTS);"/stp/tickerlog/testhdb/"),,"Clean test hdb dir"
